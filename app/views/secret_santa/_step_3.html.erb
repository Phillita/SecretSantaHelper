<%= render 'errors', object: secret_santa if secret_santa.errors.any? && !@back %>

<%= simple_form_for secret_santa do |f| %>
  <h1><%= link_to_if secret_santa.persisted?, secret_santa.name || 'New Secret Santa', secret_santa %></h1>
  <hr>
  <%= render 'shared/progress_bar', max_step: 5, step: 3, pre_title: 'Setup Step' %>
  <%= render 'step_progress_breadcrumbs', secret_santa: secret_santa, step: 3 %>
  <%= hidden_field_tag :step, @step %>
  <h2>Who's joining you?</h2>
  <details>
    <summary>Why do I show up?</summary>
    <p>We are assuming that you are a participant too!</p>
    <p>If this is incorrect, feel free to delete yourself below.</p>
  </details>
  <hr>

  <div id="secret_santa_participants">
    <%= f.fields_for :secret_santa_participants do |secret_santa_participant| %>
      <%= render 'secret_santa_participants/secret_santa_participant_fields', f: secret_santa_participant %>
    <% end %>
    <%= link_to_add_association 'Add Participant',
                                f,
                                :secret_santa_participants,
                                partial: 'secret_santa_participants/secret_santa_participant_fields',
                                data: { association_insertion_method: :after } %>
  </div>

  <%= f.submit 'Next', class: 'btn btn-success' %>
  <%= f.submit 'Back', class: 'btn btn-primary', style: 'float:left;' %>
<% end %>
